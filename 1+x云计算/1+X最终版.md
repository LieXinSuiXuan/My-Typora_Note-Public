网络管理--1

```powershell
[Huawei]interface GigabitEthernet 0/0/1
[Huawei-GigabitEthernet0/0/1]ip address 192.168.1.1 30
[Huawei-GigabitEthernet0/0/1]quit
[Huawei]interface GigabitEthernet 0/0/2
[Huawei-GigabitEthernet0/0/2]ip address 192.168.2.1 24
[Huawei-GigabitEthernet0/0/2]quit
[Huawei]ospf 1
[Huawei-ospf-1]area 0
[Huawei-ospf-1-area-0.0.0.0]network 192.168.1.0 0.0.0.3
[Huawei-ospf-1-area-0.0.0.0]network 192.168.2.0 0.0.0.255
[Huawei]interface GigabitEthernet 0/0/1
[Huawei-GigabitEthernet0/0/1]ip address 192.168.1.2 30
[Huawei-GigabitEthernet0/0/1]quit
[Huawei]interface GigabitEthernet 0/0/2
[Huawei-GigabitEthernet0/0/2]ip address 192.168.3.1 24
[Huawei-GigabitEthernet0/0/2]quit
[Huawei]ospf 1
[Huawei-ospf-1]area 0
[Huawei-ospf-1-area-0.0.0.0]network 192.168.1.0 0.0.0.3
[Huawei-ospf-1-area-0.0.0.0]network 192.168.3.0 0.0.0.255
```



网络管理--2

```powershell
[Huawei]interface GigabitEthernet 0/0/1
[Huawei-GigabitEthernet0/0/1]ip address 192.168.1.1 30
[Huawei-GigabitEthernet0/0/1]quit
[Huawei]interface GigabitEthernet 0/0/2
[Huawei-GigabitEthernet0/0/2]ip address 192.168.2.1 24
[Huawei-GigabitEthernet0/0/2]quit
[Huawei]ospf 1
[Huawei-ospf-1]area 0
[Huawei-ospf-1-area-0.0.0.0]network 192.168.1.0 0.0.0.3
[Huawei-ospf-1-area-0.0.0.0]network 192.168.2.0 0.0.0.255
[Huawei]interface GigabitEthernet 0/0/1
[Huawei-GigabitEthernet0/0/1]ip address 192.168.1.2 30
[Huawei-GigabitEthernet0/0/1]quit
[Huawei]interface GigabitEthernet 0/0/2
[Huawei-GigabitEthernet0/0/2]ip address 192.168.3.1 24
[Huawei-GigabitEthernet0/0/2]quit
[Huawei]ospf 1
[Huawei-ospf-1]area 0
[Huawei-ospf-1-area-0.0.0.0]network 192.168.1.0 0.0.0.3
[Huawei-ospf-1-area-0.0.0.0]network 192.168.3.0 0.0.0.255
```



======================================================================================================================================

[1/2/3]
hostnamectl set-hostname mycat
bash
systemctl  stop firewalld	
setenforce 0
iptables -F
iptables -X
iptables -Z
iptables-save
----------------------------------
vi /etc/hosts
192.168.32.137 mycat
192.168.32.138 db1
192.168.32.139 db2

192.168.32.137 zk1.mall
192.168.32.138 zk1.mall
192.168.32.139 zk1.mall
192.168.32.137 kafa1.mall
192.168.32.138 kafa1.mall
192.168.32.139 kafa1.mall

192.168.32.137 redis.mall
192.168.32.137 masql.mall
======================================================================================================================================

yum源管理
[root@mycat ~]# mkdir /opt/centos
[root@mycat ~]# mount CentOS-7-x86_64-DVD-1511.iso /opt/centos/
[root@mycat ~]# mv gpmall-repo/ /opt/
[root@mycat ~]# rm -rf /etc/yum.repos.d/*
[root@mycat ~]# vi /etc/yum.repos.d/local.repo
**********************************************
[centos]
name=centos
enabled=1
gpgcheck=0
baseurl=file:///opt/centos

[gpmall]
name=gpmall
enabled=1
gpgcheck=0
baseurl=file:///opt/gpmall-repo
**********************************************
[root@mycat ~]# yum clean all
[root@mycat ~]# yum repolist al

===============================================

KVM管理
[root@xnode1 ~]# yum install qemu-kvm openssl libvirt net-tools -y
[root@xnode1 ~]# systemctl start libvirtd
[root@xnode1 ~]# ln -s /usr/libexec/qemu-kvm /usr/bin/qemu-kvm
[root@xnode1 ~]# chmod +x /root/qemu-ifup-NAT 
[root@xnode1 ~]# qemu-kvm -m 1024 -drive file=cirros-0.3.4-x86_64-disk.img,if=virtio -net nic,model=virtio -net tap,script=/root/qemu-ifup-NAT -nographic -vnc :1   

======================================================================================================================================

zookeeper集群
[root@mycat ~]# yum list all | grep java
[root@mycat ~]# yum -y install java-1.8.0-openjdk.x86_64 java-1.8.0-openjdk-devel.x86_64 mariadb mariadb-server redis nginx vim vsftpd 
[root@mycat ~]# vim /etc/vsftpd/vsftpd.conf 
*****************
anon_root=/opt/
*****************
[root@mycat ~]# systemctl start vsftpd
------------------------------------------------------------
[root@db1/2 ~]# rm -rf /etc/yum.repos.d/*
[root@db1/2 ~]# vi /etc/yum.repos.d/local.repo
*************************************************************
[centos]
name=centos
enabled=1
gpgcheck=0
baseurl=ftp://192.168.32.137/centos

[gpmall]
name=gpmall
enabled=1
gpgcheck=0
baseurl=ftp://192.168.32.137/gpmall-repo
***************************************************************************************************
[root@db1/2 ~]# yum clean all
[root@db1/2 ~]# yum repolist all
[root@db1/2 ~]# yum -y install java-1.8.0-openjdk.x86_64 java-1.8.0-openjdk-devel.x86_64 vim net-tools mariadb mariadb-server
----------------------------------------------------------------------------------------------------
[root@mycat ~]# scp zookeeper-3.4.14.tar.gz  db1:/root
[root@mycat ~]# scp zookeeper-3.4.14.tar.gz  db2:/root

[root@mycat/db1/2 ~]# tar -zxvf zookeeper-3.4.14.tar.gz -C /opt/
[root@mycat/db1/2 ~]# mkdir /tmp/zookeeper
[root@mycat/db1/2 ~]# vi /tmp/zookeeper/myid
**********
1	2	3
**********
[root@mycat/db1/2 ~]# cd /opt/zookeeper-3.4.14/conf/
[root@mycat/db1/2 conf]# ll
[root@mycat/db1/2 conf]# cp -p zoo_sample.cfg zoo.cfg
[root@mycat/db1/2 conf]# vi zoo.cfg 
*****************************************
server.1=192.168.32.137:2888:3888	
server.2=192.168.32.138:2888:3888	
server.3=192.168.32.139:2888:3888	
*****************************************
[root@mycat/db1/2 conf]# cd ../bin/
[root@mycat/db1/2 bin]# ./zkServer.sh start
[root@mycat/db1/2 bin]# ./zkServer.sh status
======================================================================================================================================

kafkal集群
[root@mycat ~]# scp kafka_2.11-1.1.1.tgz  db1:/root   
[root@mycat ~]# scp kafka_2.11-1.1.1.tgz  db2:/root

[root@mycat/db1/2 ~]# tar -zxvf kafka_2.11-1.1.1.tgz  -C /opt/
[root@mycat/db1/2 ~]# cd /opt/kafka_2.11-1.1.1/config/
[root@mycat/db1/2 config]# ll
[root@mycat/db1/2 config]# vim server.properties 
*************************************************************************************
broker.id=1	2	3
listeners = PLAINTEXT://192.168.32.137	8	9:9092
zookeeper.connect=192.168.32.137:2181,192.168.32.138:2181,192.168.32.139:2181
*************************************************************************************
[root@mycat/db1/2 config]# cd ../bin/
[root@mycat/db1/2 bin]# ./kafka-server-start.sh -daemon ../config/server.properties
[root@mycat bin]#  ./kafka-topics.sh --create --zookeeper 192.168.32.137:2181 --replication-factor 1 --partitions 1 --topic test
[root@mycat/db1/2 bin]# cd
[root@mycat/db1/2 ~]# netstat -ntpl
======================================================================================================================================

主从数据库管理

[root@db1/2 ~]# vi /etc/my.cnf
*************************
mysqld]
log_bin=mysql-bin
binlog_ignore_db=mysql
server_id=138/9
*************************
[root@db1/2 ~]# systemctl start mariadb        
[root@db1/2 ~]# mysql_secure_installation 
[root@db1/2 ~]# mysql -uroot -p123456
*****
*db1*
****************************************************************************************
MariaDB [(none)]> grant all privileges on *.* to 'root'@'%' identified by '123456';
MariaDB [(none)]> grant replication slave on *.* to 'user'@'db2' identified by '123456';
MariaDB [(none)]> create database test;
****************************************************************************************
*****
*db2*
******************************************************************************************************
MariaDB [(none)]> change master to master_host='db1',master_user='user',master_password='123456';
MariaDB [(none)]> start slave;   
MariaDB [(none)]> show slave status\G
MariaDB [(none)]> show databases;																		
******************************************************************************************************

===========================================

读写分离数据库管理

[root@mycat ~]# vim /opt/mycat/conf/schema.xml
***********************************************************************************************************************
xml version="1.0"?>
<!DOCTYPE mycat:schema SYSTEM "schema.dtd">
<mycat:schema xmlns:mycat="http://io.mycat/">
        <schema name="USERDB" checkSQLschema="true" sqlMaxLimit="100" dataNode="dn1">
        </schema>
        <dataNode name="dn1" dataHost="localhost1" database="test" />
        <dataHost name="localhost1" maxCon="1000" minCon="10" balance="3"
                          writeType="0" dbType="mysql" dbDriver="native" switchType="1"  slaveThreshold="100">
                <heartbeat>select user()</heartbeat>
                <writeHost host="hostM1" url="192.168.32.138:3306" user="root"
                                   password="123456">
                        <readHost host="hostS2" url="192.168.32.139:3306" user="root" password="123456" />
                </writeHost>
        </dataHost>
</mycat:schema>
************************************************************************************************************************
vim /opt/mycat/conf/server.xml
*********
*		*
*********
[root@mycat ~]# cd /opt/mycat/bin/
[root@mycat bin]# ./mycat console
[root@mycat bin]# ./mycat start
[root@mycat bin]# netstat -ntpl
[root@mycat bin]# cd
[root@mycat ~]# mysql -h127.0.0.1 -P9066 -uroot -p123456 -e'show @@datasource;'

======================================================================================================================================

应用商城系统
[root@mycat ~]# cp -r /root/gpmall-cluster/dist/* /usr/share/nginx/html/
[root@mycat ~]# systemctl restart nginx
[root@mycat ~]# curl http://192.168.32.137/#/home

================================================================================================

keystone服务运维
[root@controller ~]# source /etc/keystone/admin-openrc.sh 
[root@controller ~]# openstack-status
[root@controller ~]# openstack user create --password 123456 --domain xiandian testuser
[root@controller ~]# openstack user set --password 000000 testuser
[root@controller ~]# openstack user show testuser

================================================================================================

Gance服务运维					
[root@controller ~]# source  /etc/keystone/admin-openrc.sh 
[root@controller ~]# glance image-create --name "cirros" --disk-format  qcow2 --container-format bare  --progress  < cirros-0.3.4-x86_64-disk.img 
[root@controller ~]# glance image-list
[root@controller ~]# glance image-show cirros
[root@controller ~]# glance image-show 958dbb15-4687-47a1-b6d9-6319acc6fe4b

================================================================================================

Cinder管理
[root@controller ~]# cinder create --name blockvolume 2
[root@controller ~]# lvmdiskscan 
[root@controller ~]# lvdisplay /dev/cinder-volumes/volume-b18cec0e-9bbd-42a5-b050-e259889b577c
[root@controller ~]# cinder extend blockvolume 3
[root@controller ~]# cinder show blockvolume

================================================================================================

对象存储管理
[root@controller ~]# touch aaa.txt
[root@controller ~]# swift post examtest
[root@controller ~]# swift upload  examtest aaa.txt
[root@controller ~]# swift list examtest
[root@controller ~]# swift stat examtest
[root@controller ~]# swift stat examtest aaa.txt

================================================================================================

Docher使用
[root@master ~]# ls
[root@master ~]# cat image.sh 
[root@master ~]# docker load -i images/nginx_latest.tar 
[root@master ~]# mkdir /opt/xiandian
[root@master ~]# docker run -itd --name xiandian-dir -v /opt/xiandian/ -p 81:80 nginx:latest
[root@master ~]# docker ps
[root@master ~]# docker inspect b2c314b5bb70 | grep -C 5 /opt/xiandian/

================================================================================================

K8S平台安装
[root@master ~]# ./install.sh 
[root@master ~]# kubectl get nodes 
[root@master ~]# kubectl get cs
[root@master ~]# kubectl get pods
[root@master ~]# kubectl get pods -A

================================================================================================



























